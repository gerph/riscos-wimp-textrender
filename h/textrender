/*******************************************************************
 * File:        textrender
 * Purpose:     Rendering interface for the WindowManager
 * Author:      Gerph
 * Date:        11 Jan 2026
 ******************************************************************/

#ifndef TEXTRENDER_H
#define TEXTRENDER_H

#include <stdbool.h>
#include <stdint.h>

#include "GContext/gcontext.h"

#define FONTNAME_MAX (256)

/* FIXME: This should move into GContext */
typedef uint32_t colour_t;

typedef struct textrender_s textrender_t;

typedef struct desktopfont_s {
    bool systemfont;
    char fontname[FONTNAME_MAX];
    uint32_t xsize, ysize;
} desktopfont_t;

/*************************************************** Gerph *********
 Function:      textrender_init
 Description:   Initialise the text rendering system
 Parameters:    gcontext-> the context we're using this render in
 Returns:       text rendering object, or NULL if failed
 ******************************************************************/
textrender_t *textrender_init(gcontext_t *gcontext);

/*************************************************** Gerph *********
 Function:      textrender_setfont
 Description:   Set the font for the text rendering operations
 Parameters:    trender-> the rendering context
 Returns:       none
 ******************************************************************/
void textrender_setfont(textrender_t *trender);


/*************************************************** Gerph *********
 Function:      textrender_setcolours
 Description:   Set the colours for the text rendering (Wimp_TextOp 0-like)
 Parameters:    trender-> the rendering context
                bg, fg = the colours to use
 Returns:       none
 ******************************************************************/
void textrender_setcolours(textrender_t *trender, colour_t bg, colour_t fg);

/*************************************************** Gerph *********
 Function:      textrender_paint
 Description:   Draw some simple text
 Parameters:    trender-> the rendering context
                text-> string to render
                x = position
                y = position
 Returns:       none
 ******************************************************************/
void textrender_paint(textrender_t *trender, const char *text, int x, int y);

/*************************************************** Gerph *********
 Function:      textrender_stringwidth
 Description:   Read the width of a string on screen (Wimp_TextOp 1-like)
 Parameters:    trender-> the rendering context
                text-> string to size, ctrl terminated)
                len = the length of the string (or <=0 for whole string)
 Returns:       the width in OS units
 ******************************************************************/
int32_t textrender_stringwidth(textrender_t *trender, const char *text, int len);

#endif
